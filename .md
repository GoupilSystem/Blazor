INTRO

Bestillingsveiviser (BV) er .NET7 Blazor Server App løsning.
Du må ha .NET SDK installert på systemet ditt for å kunne kjøre løsningen og de kommmende kommandoene.

OPPSETT

LOKALT

For å kjøre BV lokalt, må du ha også KodeverkApi kjørende.

For å gjøre det, åpne KodeverkApi med Visual Studio 2022 (igjen: med .NET 7 installert).
Config for Solution Configurations/Solution Platforms/Startup Projects er "Any CPU/BirkKodeverk.Api/Https":

Den skal åpne Swagger i den valgte nettleseren med url-typen {applicationUrl}/swagger/index.html, hvor applicationUrl defineres i BirkKodeverkAPI.Api/Properties/launchSettings.json.
For eksempel,
"https": {
       (...)
       "launchBrowser": sant,
       "launchUrl": "swagger",
       "applicationUrl": "https://localhost:7150"
       (...) }

Her er applicationUrl er https://localhost:7150.

Nå som KodeverkApi kjører, kopierer du applicationUrl til Birk.Bestillingsveiviser.Web/Birk.Client.Bestilling/appsettings.json.
Med samme eksempel:
"baseUrls": {
     "kodeverkApiBase": "https://localhost:7150/" }

Config av BV for Solution Configurations/Solution Platforms/Startup Projects er "Any CPU/Birk.Client.Bestilling/Https"

WORKFLOW

Skjemaet består av en først rullegardin som lar brukeren velge hvilken bestillingstype de ønsker å opprette, og basert på valgt type vil ytterligere inndatafelt vises.

Hvis KodeverkApi ikke kjører, vil den første rullegardinmenyen Bestilling vise "ingen data" og brukeren vil ikke kunne fortsette med prosessen.

Hvis "Henvisning" velges vises resten av skjemaet, med bla.a kommune og barneverntjeneste rullegardinmenyer.

UTVIKLING

BV kjøres med applicationUrl som definires i Birk.Bestillingsveiviser.Web/Birk.Client.Bestilling/Properties/launchSettings.json, som er også applicationUrl/bestilling.
Kodevis er det Birk.Bestillingsveiviser.Web/Birk.Client.Bestilling/Pages/Bestillings.razor komponent.

Bestilling-komponenten er ansvarlig for å vise et skjema for å opprette en ny bestilling. 

IBestillingService: En tjeneste som gir nødvendige data til skjemaet.
MudBlazor: Et brukergrensesnittbibliotek som gir komponentene som brukes i skjemaet.
Bruk
For å bruke denne komponenten må du:

Importer de nødvendige navnerommene og injiser de nødvendige tjenestene:

@using Client.Bestilling.Components
@using Client.Bestilling.Components.Enums;
@using Client.Bestilling.Components.Reusable
@using Client.Bestilling.Services.Implementation;
@using Client.Bestilling.Services.Interfaces;
@using Client.Bestilling.Utils.Constants;

@inject IBestillingService BestillingService
@inject ILogger<Bestilling> Logger

PACKAGES

I tillegg må du ha følgende pakker installert:

MudBlazor - et UI-komponentbibliotek for Blazor-applikasjoner
Microsoft.Extensions.Logging.Abstractions - en abstraksjon over loggrammeverk
Microsoft.AspNetCore.Components.WebAssembly - en pakke for å bygge Blazor WebAssembly-applikasjoner
Microsoft.AspNetCore.Components.WebAssembly.DevServer - en utviklingsserver for Blazor WebAssembly-applikasjoner
Newtonsoft.Json - en populær JSON serializer og deserializer for .NET-applikasjoner

For å installere disse pakkene kan du bruke kommandoen dotnet add package i terminalvinduet, slik:

dotnet add-pakke MudBlazor
dotnet add-pakke Microsoft.Extensions.Logging.Abstractions
dotnet add-pakke Microsoft.AspNetCore.Components.WebAssembly
dotnet add-pakke Microsoft.AspNetCore.Components.WebAssembly.DevServer
dotnet add-pakke Newtonsoft.Json

APPLIKASJONSSTRUKTUR

Applikasjonen består av gjenbrukbare komponenter som er avledet fra to hovedkomponenter: BaseComponent og GenericComponent.

BaseComponent-komponenten inneholder to parametere:

GuiType: En parameter av typen GuiType, som bestemmer typen GUI-komponent som skal renderes.
Items: En array av string som inneholder elementene som skal gjengis i komponenten.
Denne komponenten har også en egenskap CssClass som bestemmer CSS-klassen som skal brukes på komponenten, basert på verdien av GuiType.

GenericComponent-komponenten stammer fra BaseComponent og inneholder en tilleggsparameter:

Placeholder: En streng som spesifiserer placeholdersteksten som skal vises i komponenten.
Denne komponenten definerer også en privat metode kalt CreateComponent() som lager et dynamisk RenderFragment basert på verdien av GuiType. Det dynamiske RenderFragment lagres i en privat variabel kalt DynamicFragment.

OnInitialized()-metoden til GenericComponent initialiserer DynamicFragment-variabelen med verdien returnert av CreateComponent().

Enums-namespace inneholder en enumeration GuiType, som definerer de forskjellige typene GUI-komponenter som kan gjengis:
Etikett: Gjengir en etikett.
Dropdown: Gjengir en dropdown.
Tittel: Gjengir en tittel.
Inndata: Gjengir et inndatafelt.
Ved å utnytte BaseComponent- og GenericComponent-komponentene, kan utviklere enkelt lage gjenbrukbare GUI-komponenter av forskjellige typer med varierende funksjonalitet, ganske enkelt ved å spesifisere riktig GuiType-verdi og sende inn de nødvendige parameterne.

FUNKSJONALITETER
Bestilling-komponenten gir følgende funksjonalitet:

Viser en rullegardin som lar brukeren velge hvilken type ordre de vil opprette.
Basert på den valgte typen, viser flere inndatafelt for brukeren for å gi den nødvendige informasjonen.
Henter nødvendige data fra tjenesten IBestillingService.
Bruker MudBlazor-biblioteket til å vise UI-komponenter, for eksempel rullegardiner og etiketter.

KODESTRUKTUR

Bestilling-komponenten består av følgende deler:

Properties: Komponentens egenskaper, inkludert matrisene som lagrer rullegardinalternativene og de valgte verdiene.
Lifecycle: OnInitializedAsync-metoden som initialiserer komponenten og kaller InitializeGUI-metoden.
Metoder: InitializeGUI-metoden som henterdropdown options fra IBestillingService-tjenesten, og event handlers som håndterer rullegardinvalgendringene og oppdaterer komponentens state.
Rendermetode: Komponentens gjengivelsesmetode som viser skjemaet basert på den valgte rullegardinverdien.